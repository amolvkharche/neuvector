
clusterroles:
  - name: neuvector-binding-app
    verbs: 
      - get
      - list
      - watch
      - update
    resources: 
      - nodes
      - pods
      - services
      - namespaces

  - name: neuvector-binding-rbac
    verbs: 
      - get
      - list
      - watch
    resources: 
      - rolebindings.rbac.authorization.k8s.io
      - roles.rbac.authorization.k8s.io
      - clusterrolebindings.rbac.authorization.k8s.io
      - clusterroles.rbac.authorization.k8s.io

  - name: neuvector-binding-admission
    verbs: 
      - get
      - list
      - watch
      - create
      - update
      - delete
    resources: 
      - validatingwebhookconfigurations
      - mutatingwebhookconfigurations

  - name: neuvector-binding-customresourcedefinition
    verbs: 
      - watch
      - create
      - get
      - update
    resources: 
      - customresourcedefinitions

  - name: neuvector-binding-nvsecurityrules
    verbs: 
      - get
      - list
      - delete
    resources: 
      - nvsecurityrules
      - nvclustersecurityrules

  - name: neuvector-binding-nvadmissioncontrolsecurityrules
    verbs: 
      - get
      - list
      - delete
    resources: 
      - nvadmissioncontrolsecurityrules

  - name: neuvector-binding-nvdlpsecurityrules
    verbs: 
      - get
      - list
      - delete
    resources: 
      - nvdlpsecurityrules

  - name: neuvector-binding-nvwafsecurityrules
    verbs: 
      - get
      - list
      - delete
    resources: 
      - nvwafsecurityrules

  - name: neuvector-binding-nvcomplianceprofiles
    verbs: 
      - get
      - list
      - delete
    resources: 
      - nvcomplianceprofiles

  - name: neuvector-binding-nvvulnerabilityprofiles
    verbs: 
      - get
      - list
      - delete
    resources: 
      - nvvulnerabilityprofiles

clusterrolebindings:
  - name: neuvector-binding-app
    clusterrole: neuvector-binding-app
    serviceaccount: neuvector:controller

  - name: neuvector-binding-rbac
    clusterrole: neuvector-binding-rbac
    serviceaccount: neuvector:controller

  - name: neuvector-binding-admission
    clusterrole: neuvector-binding-admission
    serviceaccount: neuvector:controller

  - name: neuvector-binding-customresourcedefinition
    clusterrole: neuvector-binding-customresourcedefinition
    serviceaccount: neuvector:controller

  - name: neuvector-binding-nvsecurityrules
    clusterrole: neuvector-binding-nvsecurityrules
    serviceaccount: neuvector:controller

  - name: neuvector-binding-view
    clusterrole: view
    serviceaccount: neuvector:controller

  - name: neuvector-binding-nvwafsecurityrules
    clusterrole: neuvector-binding-nvwafsecurityrules
    serviceaccount: neuvector:controller

  - name: neuvector-binding-nvadmissioncontrolsecurityrules
    clusterrole: neuvector-binding-nvadmissioncontrolsecurityrules
    serviceaccount: neuvector:controller

  - name: neuvector-binding-nvdlpsecurityrules
    clusterrole: neuvector-binding-nvdlpsecurityrules
    serviceaccount: neuvector:controller

  - name: neuvector-binding-nvcomplianceprofiles
    clusterrole: neuvector-binding-nvcomplianceprofiles
    serviceaccount: neuvector:controller

  - name: neuvector-binding-nvvulnerabilityprofiles
    clusterrole: neuvector-binding-nvvulnerabilityprofiles
    serviceaccount: neuvector:controller

roles:
  - name: neuvector-binding-scanner
    verbs:
      - get
      - patch
      - update
      - watch
    resources:
      - deployments
    namespace: neuvector

  - name: neuvector-binding-secret
    verbs:
      - get
    resources:
      - secrets
    namespace: neuvector

rolebindings:
  - name: neuvector-binding-scanner
    role: neuvector-binding-scanner
    serviceaccounts:
      - neuvector:updater
      - neuvector:controller
    namespace: neuvector

  - name: neuvector-binding-secret
    role: neuvector-binding-secret
    serviceaccount: neuvector:controller
    namespace: neuvector
